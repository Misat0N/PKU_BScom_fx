# 基于超材料的无源物联网感知系统复现

本项目是针对论文《超越后向散射通信:超材料无源物联网感知新范式》 的Python复现项目。项目完整地模拟了从物理环境建模、无线信号传输到最终通过深度学习进行环境状态感知的全过程。

经过多次迭代优化，本项目的仿真精度和物理真实性得到了显著提升，最终实现了一个能够有效学习空间分布规律的端到端系统。

## 项目简介

系统通过模拟一个由多个无源超材料标签和一对无线收发器组成的物联网感知系统，旨在实现对特定物理量（如湿度）空间分布的精确感知。核心思想是，超材料标签的电磁散射特性会随环境物理量的变化而改变，接收器通过分析这些变化的散射信号，并利用深度神经网络来反演出环境状态的分布图。

本项目实现了以下关键模块：

* **物理环境仿真**: 模拟**单一热源/湿源的物理扩散过程**，通过高斯衰减生成平滑且符合物理直觉的湿度分布图。标签被**固定地**部署在均匀分布的位置上，以确保实验的稳定性和可复现性。
* **电磁模型**: **直接对吸收峰进行建模**，将环境湿度线性映射到谐振频率，并用高斯函数生成完美的吸收峰形态，为神经网络提供清晰、显著的信号特征。
* **信道传输模型**: 模拟包含目标信号、干扰信号、环境散射和噪声的复杂接收信号功率。
* **深度学习感知模型**: 构建一个具备**空间感知能力的U-Net型神经网络** (`SpatialSensingNetwork`)，能够理解标签的物理位置，并从稀疏的传感器数据中“脑补”和重构出完整的空间分布。

## 项目结构

```
.
├── dataset/              # 存放生成的训练和测试数据集 (.npz)
├── best_model.pth        # 训练后保存的最佳模型权重
│
├── config.py             # 所有仿真参数的配置文件
├── environment.py        # 环境和超材料标签的物理模型
├── model.py              # PyTorch实现的空间感知神经网络
├── transceiver.py        # 无线收发器和信号传输模型
│
├── generate_dataset.py   # 用于生成数据集的脚本
├── train.py              # 包含模型训练的核心逻辑 (被run_training调用)
├── run_training.py       # 【推荐】用于启动训练的主程序
├── predict.py            # 加载已训练模型，进行预测和可视化
│
├── requirements.txt      # 项目依赖库
└── README.md             # 本文档
```

## 安装与配置

本项目推荐使用 `conda` 进行环境管理，以避免复杂的编译和依赖问题。

**1. 克隆/下载项目**

将所有项目文件下载到您的本地计算机一个**纯英文路径**下。

**2. 创建并激活Conda环境**

打开Anaconda Prompt或终端，运行以下命令：

```bash
# 创建一个名为 "meta_sensing" 的新环境，并指定Python 3.9 (推荐)
conda create -n meta_sensing python=3.9 -y

# 激活新创建的环境
conda activate meta_sensing
```

**3. 安装依赖**

使用项目提供的 `requirements.txt` 文件安装所有必要的库。推荐使用 `mamba` 加速安装。

```bash
# (推荐) 安装 mamba 以获得极速体验
conda install mamba -c conda-forge -y

# 使用 mamba/conda 安装核心依赖 (它会自动处理复杂的二进制文件)
mamba install numpy pandas bottleneck scipy torch matplotlib seaborn tqdm perlin-noise -y

# 您也可以使用 pip，但conda/mamba更稳定
# pip install -r requirements.txt
```

## 使用流程

请按照以下步骤运行整个复现流程。

**步骤 1: 生成数据集**

运行数据生成脚本，创建用于模型训练和测试的数据集。

```bash
python generate_dataset.py
```
该脚本会创建一个 `dataset/` 文件夹，并在其中生成 `train_dataset.npz` 和 `test_dataset.npz`。每个文件都包含信号矩阵、湿度标签以及**固定的标签位置信息**。

**步骤 2: 训练感知模型**

运行我们最终确定的训练主程序 `run_training.py`。

```bash
python run_training.py
```
该脚本会自动加载上一步生成的数据，初始化**空间感知模型**，进行训练，并评估其性能。训练结束后，性能最佳的模型权重将被保存为 `best_model.pth`。

**步骤 3: 预测与可视化**

训练完成后，运行预测脚本来直观地检验模型的效果。

```bash
python predict.py
```
该脚本会：
1.  加载 `best_model.pth` 和测试数据集。
2.  从测试集中随机抽取一个样本进行预测。
3.  弹出一个包含两张对比图的窗口：左侧为**真实环境分布**，右侧为**模型的预测结果**，并标注本次预测的准确率。

# 基于超材料的无源物联网感知系统复现

本项目是针对论文《超越后向散射通信:超材料无源物联网感知新范式》 的Python复现项目。项目完整地模拟了从物理环境建模、无线信号传输到最终通过深度学习进行环境状态感知的全过程。

经过多次迭代优化，本项目的仿真精度和物理真实性得到了显著提升，最终实现了一个能够有效学习空间分布规律的端到端系统。

## 项目简介

系统通过模拟一个由多个无源超材料标签和一对无线收发器组成的物联网感知系统，旨在实现对特定物理量（如湿度）空间分布的精确感知。核心思想是，超材料标签的电磁散射特性会随环境物理量的变化而改变，接收器通过分析这些变化的散射信号，并利用深度神经网络来反演出环境状态的分布图。

本项目实现了以下关键模块：

* **物理环境仿真**: 模拟**单一热源/湿源的物理扩散过程**，通过高斯衰减生成平滑且符合物理直觉的湿度分布图。标签被**固定地**部署在均匀分布的位置上，以确保实验的稳定性和可复现性。
* **电磁模型**: **直接对吸收峰进行建模**，将环境湿度线性映射到谐振频率，并用高斯函数生成完美的吸收峰形态，为神经网络提供清晰、显著的信号特征。
* **信道传输模型**: 模拟包含目标信号、干扰信号、环境散射和噪声的复杂接收信号功率。
* **深度学习感知模型**: 构建一个基于PyTorch的**`SensingNetwork`**模型，它采用RNN-Encoder-Decoder架构，通过增加网络容量来学习复杂的信号到空间的映射。

## 项目结构

```
.
├── dataset/              # 存放生成的训练和测试数据集 (.npz)
├── best_model.pth        # 训练后保存的最佳模型权重
│
├── config.py             # 所有仿真参数的配置文件
├── environment.py        # 环境和超材料标签的物理模型
├── model.py              # PyTorch实现的感知神经网络
├── transceiver.py        # 无线收发器和信号传输模型
│
├── generate_dataset.py   # 用于生成数据集的脚本
├── train.py              # 包含模型训练的核心逻辑
├── predict.py            # 加载已训练模型，进行单样本预测和可视化
├── evaluate_snr.py       # (已整合)定量分析：计算不同SNR下的平均准确率
├── visual_evaluate_snr.py# (已整合)定性分析：可视化不同SNR下的预测图
├── master_evaluate.py    # 【推荐】用于评估的集大成脚本
│
├── requirements.txt      # 项目依赖库
└── README.md             # 本文档
```

## 安装与配置

本项目推荐使用 `conda` 进行环境管理，以避免复杂的编译和依赖问题。

**1. 克隆/下载项目**

将所有项目文件下载到您的本地计算机一个**纯英文路径**下。

**2. 创建并激活Conda环境**

打开Anaconda Prompt或终端，运行以下命令：

```bash
# 创建一个名为 "PKU-fx" 的新环境，并指定Python 3.9 (推荐)
conda create -n PKU-fx python=3.9 -y

# 激活新创建的环境
conda activate PKU-fx
```

**3. 安装依赖**

使用项目提供的 `requirements.txt` 文件安装所有必要的库。推荐使用 `mamba` 加速安装。

```bash
# (可选，但推荐) 安装 mamba 以获得极速体验
conda install mamba -c conda-forge -y

# 使用 mamba/conda 安装核心依赖 (它会自动处理复杂的二进制文件)
mamba install numpy pandas bottleneck scipy torch matplotlib seaborn tqdm perlin-noise -y
```

## 使用流程

请按照以下步骤运行整个复现流程。

**步骤 1: 生成数据集**

运行数据生成脚本，创建用于模型训练和测试的数据集。

```bash
python generate_dataset.py
```

该脚本会创建一个 `dataset/` 文件夹，并在其中生成 `train_dataset.npz` 和 `test_dataset.npz`。

**步骤 2: 训练感知模型**

运行训练脚本 `train.py`。

```bash
python train.py
```

该脚本会自动加载上一步生成的数据，进行模型训练，并评估其性能。训练结束后，性能最佳的模型权重将被保存为 `best_model.pth`。

**步骤 3: 综合评估模型**

训练完成后，运行集成的评估脚本 `master_evaluate.py` 来全面检验模型的效果。

```bash
python master_evaluate.py
```

该脚本会依次执行：

1. **输入矩阵可视化**：为每个信噪比水平，展示对应的输入信号矩阵热力图。
2. **定性（可视化）分析**：针对一个固定的真实场景，并排展示在不同信噪比下的模型预测图。
3. **定量（统计）分析**：计算并绘制模型在不同信噪比下的平均准确率折线图。

**单样本预测**

如果您只想快速查看模型在某个随机样本上的表现，可以运行 `predict.py`。

```bash
python predict.py
```
